{% extends 'base.html' %}

{% block title %}{{ item.title }}{% endblock %}

{% block content %}
<div class="header">
    <!-- <p class="user-string-horizontal"><span class="tag">{{ item.feed_title }}</span> {{ item.title }}</p> -->
    <p class="user-string-horizontal">{{ item.title }}</p>
    <div class="header-right">
        <a href="javascript:history.back()" style="text-decoration: none;">↩️</a>
    </div>
</div>
{% for item in items %}
<div class="item-image-container">
    {% if item.video_url %}
    <video
        id="media-{{ loop.index }}"
        class="item-image item-image-contained"
        src="{{ item.video_url }}"
        muted
        autoplay
        loop
        {% if loop.index != u_index + 1 %} style="display: none;" {% endif %}
        onclick="e => e.preventDefault(); nextMedia({{ items|length }});"
    />
    {% elif item.image_url %}
    <img
        id="media-{{ loop.index }}"
        class="item-image item-image-contained"
        src="{{ item.image_url }}"
        {% if loop.index != u_index + 1 %} style="display: none;" {% endif %}
        onclick="e => e.preventDefault(); nextMedia();"
    />
    {% endif %}
    <div
        id="media-overlay-{{ loop.index }}"
        class="item-image-overlay next-media"
        {% if loop.index != u_index + 1 %} style="display: none;" {% endif %}
    >{{ loop.index }}/{{ items|length }}</div> 
</div>
{% endfor %}
<div class="item-share-buttons">
    <!-- open link -->
    <a href="{{ item.url }}" target="_blank">
        <svg
            role="img"
            xmlns="http://www.w3.org/2000/svg"
            class="item-share-button"
            width="48"
            height="48"
            viewBox="0 0 128 128"
        >
            <path fill="#FAFAFA" d="m87.391 63.211c-0.48828-0.73828-1-1.4414-1.5586-2.1211 0.53906 0.67969 1.0664 1.3789 1.5586 2.1211z"/>
            <path fill="#FAFAFA" d="m62.82 81.641c-0.26562-0.12891-0.51172-0.29297-0.73047-0.49219 0.21875 0.19922 0.46484 0.36328 0.73047 0.49219z"/>
            <path fill="#FAFAFA" d="m50 97.5c10.723 0.027344 21.129-3.6016 29.512-10.289l-0.058594-0.10938h-0.003906c-1.1367-1.8047-2.5039-3.4531-4.0703-4.9023-0.71094 0.55859-1.4297 1.1016-2.1719 1.6094l-0.089843 0.16016h0.003906c-1.832 3.1172-5.1875 5.0234-8.8008 5h-0.44141c-2.1328-0.074219-4.1875-0.81641-5.8789-2.1172-1.3359 1.4922-2.9727 2.6875-4.8008 3.5078v-10.598l-3.0703-6-1.8711-3.6211-1.3711-2.6602c-0.88672-1.7422-1.8164-3.4805-2.7383-5.3086-3.9961 0.40234-7.9414 1.2383-11.758 2.4883-0.68359-3.7773-1.0938-7.5938-1.2305-11.43h11.418c0.078125-0.28125 0.14844-0.55078 0.25-0.82812v-0.003906c0.90234-2.4883 2.7266-4.5391 5.0938-5.7266l5.3086-2.7305v-7.1133c4.8164-0.23047 9.5859-1.043 14.211-2.418 0.12891 0.67188 0.23828 1.3516 0.35156 2l2.6484-1.3594c1.0859-0.54688 2.2617-0.90234 3.4688-1.0508-0.10938-0.58984-0.21094-1.1914-0.32812-1.7695h-0.003906c3.5547-1.5234 6.9102-3.4609 10-5.7812 4.2266 5.9922 6.7539 13.012 7.3203 20.32h-5.6172c0 0.19922-0.10156 0.41016-0.16016 0.60938-0.28906 0.89062-0.57031 1.7891-0.85156 2.6797 1.5742 0.94922 3.0781 2.0117 4.5 3.1719h2.1289c0 0.57812-0.12109 1.1484-0.19141 1.7188h0.003907c2.0469 1.918 3.8672 4.0625 5.4297 6.3906 0.90234-3.7109 1.3594-7.5195 1.3594-11.34 0-12.598-5.0039-24.684-13.91-33.59-8.9102-8.9102-20.992-13.914-33.59-13.914s-24.684 5.0039-33.59 13.914c-8.9102 8.9062-13.914 20.992-13.914 33.59s5.0039 24.68 13.914 33.59c8.9062 8.9062 20.992 13.91 33.59 13.91zm29.41-76.07c-2.3281 1.7305-4.832 3.207-7.4688 4.4102-0.89453-2.9531-2.0312-5.8242-3.4023-8.5898-0.90625-1.8281-1.9531-3.582-3.1289-5.25 5.2695 2.1406 10.035 5.3516 14 9.4297zm-26.18-11.789c3.4688 1.4297 6.8203 5.0781 9.5312 10.512v-0.003906c1.2656 2.5742 2.3125 5.25 3.1289 8-4.1172 1.2383-8.3672 1.9805-12.66 2.2109zm-6.4609 58.801v21.918c-3.4688-1.4297-6.7695-5.0781-9.5312-10.508-1.3945-2.8398-2.5273-5.8047-3.3789-8.8516 4.168-1.4297 8.5117-2.293 12.91-2.5586zm-15.309 14.309c0.90625 1.8281 1.9531 3.582 3.1289 5.25-5.332-2.168-10.148-5.4336-14.141-9.5781 2.2852-1.9023 4.7734-3.5469 7.4219-4.9023 0.92188 3.1758 2.1211 6.2656 3.5898 9.2305zm15.309-36h-15.609c0.14844-4.1484 0.61719-8.2812 1.3984-12.359 4.625 1.3672 9.3945 2.1797 14.211 2.418zm0-37.129v20.73c-4.2891-0.23437-8.5352-0.98047-12.648-2.2227 0.80469-2.75 1.8516-5.4258 3.1172-8 2.7617-5.4102 6.0625-9.0586 9.5312-10.488zm-12.18 2.3789c-1.1797 1.6719-2.2266 3.4336-3.1289 5.2695-1.3672 2.7617-2.5039 5.6328-3.4023 8.582-2.6367-1.1992-5.1406-2.6758-7.4688-4.4023 3.9609-4.0859 8.7305-7.3008 14-9.4492zm-18.141 14.41c3.0898 2.3164 6.4492 4.2539 10 5.7695-0.99219 4.8047-1.5703 9.6875-1.7305 14.59h-15.617c0.56641-7.3242 3.1055-14.359 7.3477-20.359zm-7.3477 26.82h15.59c0.15234 4.6602 0.6875 9.3047 1.5898 13.879-3.5625 1.6875-6.8984 3.8164-9.9297 6.332-4.1836-5.9688-6.6875-12.945-7.25-20.211z"/>
            <path fill="#FAFAFA" d="m75.91 53.199c0.69141-2.1406 1.3711-4.2891 2-6.4297-0.62891 2.1406-1.3086 4.2891-2 6.4297z"/>
            <path fill="#FAFAFA" d="m67.148 80.32c0.15625-0.27734 0.28125-0.56641 0.37109-0.87109l2.6094-8.1484-2.6094 8.1484c-0.089843 0.30469-0.21484 0.59375-0.37109 0.87109z"/>
            <path fill="#FAFAFA" d="m88.828 63.199c-0.41016-0.51172-0.83984-1-1.2812-1.5117s-1.0586-1.1094-1.6211-1.6406c-0.55859-0.53125-1.4492-1.2812-2.2188-1.8789l0.003907 0.003906c-1.0859-0.84375-2.2188-1.6211-3.4023-2.3203-0.66016-0.39062-1.3516-0.73828-2-1.0703l-2.0898-1-0.39062-0.17969 0.12891-0.39844c0.69141-2.1406 1.3711-4.2891 2-6.4297l0.48047-1.5 0.003906-0.003907c0.1875-0.57812 0.22266-1.1953 0.097656-1.7891-0.20703-0.97266-0.84375-1.7969-1.7305-2.2422-0.26172-0.10547-0.53125-0.18359-0.80859-0.23828-0.089844-0.003906-0.17969-0.003906-0.26953 0-0.16797-0.035156-0.33984-0.054688-0.51172-0.058594-0.17969 0.011719-0.35938 0.035156-0.53906 0.070313h-0.26172 0.003906c-0.27734 0.074219-0.54688 0.17578-0.80078 0.30859l-5.4805 2.8281-17.012 8.75c-0.39453 0.19141-0.75 0.45312-1.0508 0.77344-0.14062 0.15625-0.26562 0.32812-0.37891 0.50781-0.11328 0.19141-0.20703 0.39062-0.27734 0.60156-0.16406 0.44141-0.23438 0.91797-0.20312 1.3906 0.023438 0.23047 0.070312 0.45703 0.14062 0.67969 0.066406 0.23047 0.15625 0.45313 0.26953 0.66797 1.625 3.1523 3.2539 6.3008 4.8789 9.4414l6.7539 13.039c0.070312 0.14453 0.14844 0.28516 0.23828 0.42188 0.16406 0.25391 0.36328 0.48438 0.58984 0.6875 0.21875 0.19922 0.46484 0.36328 0.73047 0.49219 0.42188 0.1875 0.87891 0.29297 1.3398 0.30859h0.21875c0.26172-0.007812 0.51953-0.039062 0.76953-0.10156h0.089843c0.24219-0.066406 0.47266-0.16016 0.69141-0.27734 0.22656-0.13281 0.42969-0.29297 0.60937-0.48047 0.19922-0.20703 0.37891-0.4375 0.53125-0.67969 0.15234-0.27734 0.27734-0.57031 0.37109-0.87109l2.6094-8.1484 0.14844-0.48828c1.1602 0.55078 2.2812 1 3.3516 1.6094v-0.003906c4.8203 2.5391 8.8984 6.293 11.82 10.891 0.26172 0.42188 0.51953 0.83984 0.76172 1.2695 0.48047 0.85156 0.92969 1.7188 1.3281 2.6094 0.39844 0.89062 0.75 1.7617 1.0703 2.7617s0.5 1.6094 0.71094 2.4414c0.14844 0.60156 0.28906 1.1992 0.41016 1.8203h-0.003906c0.09375 0.76562 0.61719 1.4141 1.3516 1.6602 0.17578 0.058594 0.36328 0.085937 0.55078 0.089844h0.089844c0.15625 0 0.31641-0.023438 0.46875-0.0625h0.089844c0.13281-0.050781 0.25781-0.10938 0.37891-0.17969h0.0625c0.13281-0.082031 0.25-0.1875 0.34766-0.30859l0.070313-0.089844c0.10938-0.12891 0.19531-0.27734 0.26172-0.42969 0.19922-0.46094 0.37891-0.92188 0.55078-1.3789v-0.003906c0.34766-0.92969 0.64062-1.8828 0.87891-2.8477 0.12109-0.48047 0.23047-1 0.32812-1.4492 0.34766-1.6797 0.55859-3.3828 0.64062-5.0898 0.22656-5.0664-0.80469-10.105-3-14.672-0.67578-1.4219-1.4492-2.7969-2.3203-4.1094-0.5-0.80078-1.0195-1.5-1.5703-2.1914z"/>
        </svg>
    </a>
    <!-- mastodon -->
    <svg
        role="img"
        xmlns="http://www.w3.org/2000/svg"
        class="item-share-button"
        width="48"
        height="48"
        viewBox="0 0 32 32"
        onclick="alert('Work in progress...')"
    >
        <path fill="#FAFAFA" d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"/>
    </svg>
    {% if is_instapaper_available %}
    <!-- instapaper -->
    <svg
        role="img"
        xmlns="http://www.w3.org/2000/svg"
        class="item-share-button"
        width="48"
        height="48"
        viewBox="0 0 32 32"
        hx-post="/actions/instapaper?url={{ item.ui_extra['quoted_url'] }}"
        hx-swap="none"
        hx-disabled-elt="this"
    >
        <path fill="#FAFAFA" d="M14.766 20.259c0 1.819.271 2.089 2.934 2.292V24H6.301v-1.449c2.666-.203 2.934-.473 2.934-2.292V3.708c0-1.784-.27-2.089-2.934-2.292V0h11.398v1.416c-2.662.203-2.934.506-2.934 2.292v16.551z"/>
    </svg>
    {% endif %}
    {% if is_pocket_available %}
    <!-- pocket -->
    <svg
        role="img"
        xmlns="http://www.w3.org/2000/svg"
        class="item-share-button"
        width="48"
        height="48"
        viewBox="0 0 32 32"
        hx-post="/actions/pocket?url={{ item.ui_extra['quoted_url'] }}{{ item.ui_extra['encoded_tags'] }}"
        hx-swap="none"
        hx-disabled-elt="this"
    >
        <path fill="#FAFAFA" d="M18.813 10.259l-5.646 5.419c-.32.305-.73.458-1.141.458-.41 0-.821-.153-1.141-.458l-5.646-5.419c-.657-.628-.677-1.671-.049-2.326.63-.657 1.671-.679 2.325-.05l4.511 4.322 4.517-4.322c.66-.631 1.697-.607 2.326.049.631.645.615 1.695-.045 2.326l-.011.001zm5.083-7.546c-.299-.858-1.125-1.436-2.041-1.436H2.179c-.9 0-1.717.564-2.037 1.405-.094.25-.142.511-.142.774v7.245l.084 1.441c.348 3.277 2.047 6.142 4.682 8.139.045.036.094.07.143.105l.03.023c1.411 1.03 2.989 1.728 4.694 2.072.786.158 1.591.24 2.389.24.739 0 1.481-.067 2.209-.204.088-.029.176-.045.264-.06.023 0 .049-.015.074-.029 1.633-.36 3.148-1.036 4.508-2.025l.029-.031.135-.105c2.627-1.995 4.324-4.862 4.686-8.148L24 10.678V3.445c0-.251-.031-.5-.121-.742l.017.01z"/>
    </svg>
    {% endif %}
    <!-- share -->
    <svg
        id="item-share-web-share-button"
        role="img"
        xmlns="http://www.w3.org/2000/svg"
        class="item-share-button"
        width="48"
        height="48"
        viewBox="0 0 128 128"
        onclick="navigator.share({'url': '{{ item.ui_extra["shareable_url"] }}'})"
    >
        <path fill="#FAFAFA" d="m46.879 43.328 6.9414-4.1719c3.7305-2.2383 8.3008-2.7617 12.371-1.2109 2.4102 0.92188 5.1289 1.1992 7.9492 0.67188 5.6289-1.0703 10.18-5.5703 11.309-11.191 2.0312-10.09-6.5586-18.91-16.609-17.219-5.3594 0.89844-9.8008 4.9297-11.371 10.129-0.25 0.82031-0.41016 1.6211-0.51172 2.4102-0.53906 4.3203-3.3008 8.0586-7.0312 10.301l-4.2383 2.5391c-3.6406 2.1797-8.0391 2.3281-12.02 0.85937-1.5508-0.57031-3.2305-0.89062-4.9805-0.89062-8.9297 0-16 8.1797-14.141 17.43 1.1289 5.6211 5.6797 10.121 11.309 11.191 2.8203 0.53906 5.5391 0.25 7.9492-0.67188 4.0703-1.5508 8.6289-1.0312 12.371 1.2109l6.9219 4.1484c2.3398 1.3984 3.7617 3.9297 3.7617 6.6484v0.039062c0 8.9102 8.1406 15.961 17.359 14.148 5.6211-1.1016 10.141-5.6289 11.25-11.25 1.8086-9.2188-5.2383-17.359-14.148-17.359-1.75 0-3.4297 0.32031-4.9805 0.89062-3.9805 1.4688-8.3711 1.3203-12.012-0.85938l-7.4609-4.4805c-2.3203-1.3906-3.7383-3.8984-3.7383-6.6094v-0.078125c-0.007812-2.7031 1.4219-5.2227 3.75-6.625z"/>
    </svg>
</div>
<p>{{ item.text }}</p>
<script>
    window.U_INDEX = {{ u_index }};
    window.TOTAL_MEDIA_COUNT = {{ items|length }};
</script>
<script src="{{ url_for('static', filename='item.js') }}"></script>
{% endblock %}
